#!/bin/sh
#
#
# A shell script to modify a workspace to make it suitable
# for the SCSL release of the source.  We get rid of mbox
# and remote protocol providers, as well as lots of internal-only
# tests and stuff.
#
# First, remove permission for anyone to putback this workspace.
#
cd $CODEMGR_WS
ed - Codemgr_wsdata/access_control <<'EOF'
/^putback-from/c
putback-from	-
.
w
q
EOF
#
# Next, remove the files that don't belong here.
#
workspace filerm \
	src/share/classes/com/sun/mail/pop3/POP3RemoteStore.java \
	src/share/classes/com/sun/mail/mbox \
	src/share/classes/com/sun/mail/remote \
	src/share/classes/demo/internal \
	src/share/classes/javax/mail/internet/tests \
	src/share/doc/readmes \
	src/share/doc/schedule \
	src/share/lib/javamail.mbox.provider \
	src/solaris \
	build/solaris/com/sun/mail/mbox \
	build/solaris/com/sun/mail/remote \
	build/solaris/demo/internal \
	build/share/minclude/com_sun_mail_mbox.jmk \
	build/share/minclude/com_sun_mail_remote.jmk \
	build/share/minclude/com_sun_mail_mbox.cmk \
	build/share/minclude/internal.jmk \
	build/solaris/scslize
#
# Fix the one included makefile to allow it to build.
#
cd build/share/minclude
sccs edit com_sun_mail_pop3.jmk
ed - com_sun_mail_pop3.jmk <<'EOF'
g/POP3RemoteStore/d
w
q
EOF
sccs delget com_sun_mail_pop3.jmk <<'EOF'
remove POP3RemoteStore for SCSL release
EOF
cd $CODEMGR_WS
#
# Finally, fix the one GNUmakefile to allow it to build.
#
cd build/solaris/com/sun/mail
sccs edit GNUmakefile
ed - GNUmakefile <<'EOF'
/^SUBDIRS/s/mbox//
/^SUBDIRS/s/remote//
w
q
EOF
sccs delget GNUmakefile <<'EOF'
remove mbox and remote for SCSL release
EOF
cd $CODEMGR_WS
#
# XXX - should get rid of stuff from top level GNUmakefile
